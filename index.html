<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Text To Speech Generator</title>

<link rel="manifest" href="manifest.json">

<script src="https://cdn.jsdelivr.net/npm/@gradio/client/dist/index.min.js"></script>

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:'Segoe UI',sans-serif;
}

body{
    min-height:100vh;
    background:linear-gradient(135deg,#141e30,#243b55);
    display:flex;
    justify-content:center;
    align-items:center;
    padding:20px;
    animation:fadeIn 0.8s ease-in-out;
}

@keyframes fadeIn{
    from{opacity:0;transform:translateY(10px);}
    to{opacity:1;transform:translateY(0);}
}

.container{
    width:100%;
    max-width:550px;
    background:#ffffff;
    padding:30px;
    border-radius:20px;
    box-shadow:0 20px 40px rgba(0,0,0,0.3);
}

h1{
    text-align:center;
    margin-bottom:20px;
    color:#243b55;
}

textarea{
    width:100%;
    height:120px;
    padding:15px;
    border-radius:12px;
    border:1px solid #ddd;
    font-size:16px;
    resize:none;
    margin-bottom:15px;
}

select, input[type="number"]{
    width:100%;
    padding:12px;
    border-radius:10px;
    border:1px solid #ddd;
    margin-bottom:15px;
}

button{
    width:100%;
    padding:12px;
    border:none;
    border-radius:12px;
    background:#243b55;
    color:white;
    font-size:16px;
    cursor:pointer;
    transition:0.3s;
    margin-bottom:10px;
}

button:hover{
    background:#141e30;
}

.stop-btn{
    background:#dc3545;
}

.stop-btn:hover{
    background:#bb2d3b;
}

.download-btn{
    background:#198754;
}

.download-btn:hover{
    background:#146c43;
}

.audio-result{
    margin-top:15px;
    display:none;
}

.audio-result.show{
    display:block;
}

footer{
    text-align:center;
    font-size:14px;
    margin-top:15px;
    color:#777;
}

.spinner{
    border:3px solid #fff;
    border-top:3px solid transparent;
    border-radius:50%;
    width:18px;
    height:18px;
    display:inline-block;
    animation:spin 1s linear infinite;
}

@keyframes spin{
    to{transform:rotate(360deg);}
}
</style>
</head>
<body>

<div class="container">
<h1>üéô Text To Speech</h1>

<textarea id="prompt" placeholder="Enter your text..."></textarea>

<select id="emotion">
<option value="Neutral">Neutral</option>
<option value="Happy">Happy</option>
<option value="Sad">Sad</option>
<option value="Angry">Angry</option>
</select>

<input type="number" id="seed" placeholder="Seed (optional)" />

<button id="generateBtn">
<span id="btnText">Generate Speech</span>
</button>

<button class="stop-btn" id="stopBtn">Stop Audio</button>

<div class="audio-result" id="audioResult">
<audio id="audioPlayer" controls style="width:100%;margin-bottom:10px;"></audio>
<button class="download-btn" id="downloadBtn">Download Audio</button>
<button class="download-btn" id="copyBtn">Copy Text</button>
</div>

<footer>
Made with ‚ù§Ô∏è by Govind
</footer>

</div>

<script>
const promptInput = document.getElementById("prompt");
const emotionSelect = document.getElementById("emotion");
const seedInput = document.getElementById("seed");
const generateBtn = document.getElementById("generateBtn");
const btnText = document.getElementById("btnText");
const audioResult = document.getElementById("audioResult");
const audioPlayer = document.getElementById("audioPlayer");
const stopBtn = document.getElementById("stopBtn");
const downloadBtn = document.getElementById("downloadBtn");
const copyBtn = document.getElementById("copyBtn");

let currentAudioURL = null;

generateBtn.addEventListener("click", async () => {

    const text = promptInput.value.trim();
    if(!text){
        alert("Please enter text");
        return;
    }

    btnText.innerHTML = '<span class="spinner"></span> Generating...';
    generateBtn.disabled = true;

    try{
        const client = await window.gradio_client.Client.connect("YOUR_API_ENDPOINT");

        const result = await client.predict("/predict", [
            text,
            emotionSelect.value,
            seedInput.value || null
        ]);

        const audioURL = result.data[0];
        currentAudioURL = audioURL;

        audioPlayer.src = audioURL;
        audioResult.classList.add("show");
        audioResult.scrollIntoView({behavior:"smooth"});

    }catch(error){
        alert("Error generating speech");
        console.error(error);
    }

    btnText.innerHTML = "Generate Speech";
    generateBtn.disabled = false;
});

stopBtn.addEventListener("click", ()=>{
    audioPlayer.pause();
    audioPlayer.currentTime = 0;
});

downloadBtn.addEventListener("click", async ()=>{
    if(!currentAudioURL) return;

    const response = await fetch(currentAudioURL);
    const blob = await response.blob();
    const url = window.URL.createObjectURL(blob);

    const link = document.createElement("a");
    link.href = url;
    link.download = "tts-audio.mp3";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
});

copyBtn.addEventListener("click", ()=>{
    navigator.clipboard.writeText(promptInput.value);
    alert("Text copied!");
});

if('serviceWorker' in navigator){
    navigator.serviceWorker.register('service-worker.js');
}
</script>

</body>
</html>
